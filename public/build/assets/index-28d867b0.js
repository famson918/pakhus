import{l as g,M as B,j as D,c as M,T as y,C as L,i as R,E as T,o,b as n,d as e,t as s,v as U,A as P,B as $,h as r,F as x,s as F,D as j}from"./app-92ca493c.js";import{d as V,u as A,a as k,r as C,m as N}from"./rules-ff33fc86.js";function z(){const p=g({name:"",email:""});B();const c=g({}),d=g(!1),u=D("$swal"),v=M(()=>y.state.lang.locale);return{profile:p,getProfile:async()=>{p.value=y.getters["auth/user"]},updateProfile:async h=>{d.value||(d.value=!0,c.value={},axios.put("/api/user",h).then(({data:a})=>{a.success&&(y.commit("auth/SET_USER",a.data),v.value==="en"?u({icon:"success",title:"Profile updated successfully"}):u({icon:"success",title:"个人资料更新成功"}))}).catch(a=>{var m;(m=a.response)!=null&&m.data&&(c.value=a.response.data.errors)}).finally(()=>d.value=!1))},validationErrors:c,isLoading:d}}const G={class:"card border-0 p-7",style:{width:"90%"}},H={class:"card-header bg-transparent"},I={class:"float-start"},J={class:"card-body"},K={class:"mb-3"},O={for:"name",class:"form-label"},Q={class:"text-danger mt-1"},W={class:"text-danger mt-1"},X={class:"mb-3"},Y={for:"email",class:"form-label"},Z={class:"text-danger mt-1"},ee={class:"text-danger mt-1"},se={class:"mb-3"},ae=["disabled"],te={class:""},ie={key:0},le={key:1},re={__name:"index",setup(p){V("required",C),V("min",N);const c={name:"required|min:3",email:"required"},{validate:d,errors:u}=A({validationSchema:c}),{value:v}=k("name",null,{initialValue:""}),{value:w}=k("email",null,{initialValue:""}),{profile:_,getProfile:h,updateProfile:a,validationErrors:m,isLoading:b}=z(),t=L({name:v,email:w});function q(){d().then(i=>{i.valid&&a(t)})}return R(()=>{h()}),T(()=>{t.name=_.value.name,t.email=_.value.email}),(i,f)=>{var E,S;return o(),n("div",G,[e("div",H,[e("h5",I,s(i.$t("profile")),1)]),e("div",J,[e("form",{onSubmit:U(q,["prevent"])},[e("div",K,[e("label",O,s(i.$t("name")),1),P(e("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=l=>t.name=l),class:"form-control",id:"name"},null,512),[[$,t.name]]),e("div",Q,s(r(u).name),1),e("div",W,[(o(!0),n(x,null,F((E=r(m))==null?void 0:E.name,l=>(o(),n("div",null,s(l),1))),256))])]),e("div",X,[e("label",Y,s(i.$t("email")),1),P(e("input",{type:"email","onUpdate:modelValue":f[1]||(f[1]=l=>t.email=l),class:"form-control",id:"email"},null,512),[[$,t.email]]),e("div",Z,s(r(u).email),1),e("div",ee,[(o(!0),n(x,null,F((S=r(m))==null?void 0:S.email,l=>(o(),n("div",null,s(l),1))),256))])]),e("div",se,[e("button",{disabled:r(b),class:"btn btn-primary"},[P(e("div",te,null,512),[[j,r(b)]]),r(b)?(o(),n("span",ie,s(i.$t("processing")),1)):(o(),n("span",le,s(i.$t("update")),1))],8,ae)])],32)])])}}};export{re as default};
